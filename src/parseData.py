import tensorflow as tf

def parse_csv(line):
    
    example_defaults = [[0.], [0.], [0.], [0.], [0]]  # sets field types
    parsed_line = tf.decode_csv(line, example_defaults)
    
    # First 4 fields are features, combine into single tensor
    features = tf.reshape(parsed_line[:-1], shape=(4,))
    
    # Last field is the label
    label = tf.reshape(parsed_line[-1], shape=())
    
    return features, label